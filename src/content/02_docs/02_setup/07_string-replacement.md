---
title: Custom string replacement
menu: String replacement
description: How to modify built files using custom string replacement and event hooks.
date: 2025-01-23
priority: 0.9
tags: configure, string replacement, event hooks
---

You often want to change strings in built files. For example:

* To replace specific strings with others.
* To implement WordPress-like short codes, e.g. `−−COPYRIGHT−−` becomes `--COPYRIGHT--` where the year is generated by code.
* To add functionality that isn't possible in other ways, e.g. define `<aside>`{language=html}, `<section>`{language=html}, or `<article>`{language=html} [blocks in markdown](--ROOT--docs/recipe/content/semantic-markdown/).

Publican provides two output manipulation options:

1. [simple string replacement](#simple-string-replacement)
1. [event function hooks](#event-function-hooks)


## Simple string replacement

You can search and replace strings in the final built files using the `publican.config.replace` [Map](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Map) in your `publican.config.js` configuration file. (Note that [pass-through files](--ROOT--docs/setup/pass-through-files/) are ignored.)

```js
publican.config.replace.set(<search>, <replace>);
```

where:

* `<search>` is a search string or regular expression
* `<replace>` is the replacement string

You can set as many search and replace options as you like.

{aside}
### Replacement exceptions

This page uses an alternative Unicode characters that looks like a `-` minus to ensure explicit names like `−−ROOT−−` are not replaced by Publican!
{/aside}


### Server root example

The following code replaces all references to `−−ROOT−−` with the server's [root directory](--ROOT--docs/reference/publican-options/#root-server-path) (normally `/`):

```js
publican.config.replace.set(
  '−−ROOT−−',
  publican.config.root
);
```

This allows you to create links in markdown that automatically change when a different root directory is used, e.g.

```md
* [Home](−−ROOT−−)
* [About us](−−ROOT−−about/)
* [Contact us](−−ROOT−−about/contact/)
```


### Date formatting example

The following code uses a regular expression to convert `YYYY-MM-DD` dates to `DD-MM-YYYY` format:

```js
publican.config.replace.set(
  /(\d{4})-(\d{2})-(\d{2})/g,
  '$3-$2-$1'
);
```


### Copyright year example

The following code replaces `−−COPYRIGHT−−` with a copyright symbol and the current year (`--COPYRIGHT--`):

```js
publican.config.replace.set(
  '−−COPYRIGHT−−',
  `&copy;${ (new Date()).getUTCFullYear() }`
);
```


### Table style examples

Tables defined in markdown apply an inline `style` attribute when cells are aligned right or center. You can replace this with a `class` using the following code:

```js
publican.config.replace.set( ' style="text−align:right"', ' class="right"' );
publican.config.replace.set( ' style="text−align:center"', ' class="center"' );
```


## Event function hooks

Functions can be defined in your [configuration](--ROOT--docs/setup/configuration/) file that are called when specific events occur during the build. Functions typically inspect, add, alter, or remove data.

The two most useful hooks for string replacement are [`processContent`](#processcontent) and [`processPostRender`](#processpostrender). For more information, refer to the [event functions reference](--ROOT--docs/reference/event-functions/).


### `processContent`

This function hook is called after a [content file](--ROOT--docs/setup/content/) (or [virtual file](--ROOT--docs/setup/content/#virtual-content-files)) is loaded and parsed.

Function parameters:

1. `data` (object): the content file's parsed [post properties](--ROOT--docs/reference/content-properties/#core-post-properties).
1. `filename` (string): the filename relative to the [content directory](--ROOT--docs/setup/content/#content-file-location).

Your function can examine and change any `data` property because it's passed by reference. Return values are ignored.

```js
// example processContent hook
// prepend the word "POST: " to every title
publican.config.processContent.add(
  (data, filename) => {
    data.title = 'POST: ' + data.title;
  }
);
```


### `processPostRender`

This function hook called after each page has been fully rendered, prior to minification and saving to the file system.

Function parameters:

1. `output` (string): the rendered content.
1. `data` (object): the [post `data` object](--ROOT--docs/reference/content-properties/).
1. `tacs` (object): the [global `tacs` object](--ROOT--docs/reference/global-properties/).

The function can examine, change, and return a updated `output` string:

```js
// example processPreRender hook
// add Publican <meta> tag to HTML content
publican.config.processPostRender.add(
  (output, data) => {
    if (data.isHTML) {
      output = output.replace(
        '</head>',
        '<meta name="generator" content="Publican" />\n</head>\n'
      );
    }
    return output;
  }
);
```
